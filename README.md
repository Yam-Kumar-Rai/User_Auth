Practical Documentation 
Practical link: https://github.com/Yam-Kumar-Rai/User_Auth.git

This practical is a backend application made using Node.js and Express.js to handle registration for semesters at Sherubtse College. It contains user registration, email verifying, login, password reset, and session handling using JWT (JSON Web Tokens). This application uses PostgreSQL as its database, and the rest of the technologies are bcrypt for encrypting passwords, node mailer for sending emails, EJS for rendering web pages, and dotenv for handling the environment variables. 
For signing up, users are expected to enter in their name, email, and password. The system first looks to see if the user has an entry in the database. If the code is invalid, it creates a bcrypt hash of the password and sets is verified flag to false for the new user. Next, a verification token is uniquely created using the uuidv4 () function. The token is sent to the email account of the user, and the verification link is attached to it thanks to node mailer. The user has to click on this link to validate their email. It means that nobody can use the system without a real, valid email address.
 It is the /verify-email route’s job to check that a user is verified. When the user clicks the verification link, the token is sent to the server and then looked up in the user_tokens table. If the hashed passwords match, it marks the user’s is verified column to true in the database. To avoid reusing it, the token is removed from the table. This takes care of ensuring that only verified accounts can log into the website
When a person tries to log in, the system checks both their existence in the database and the verification of their email. Should this happen, bcrypt’s compare function is used to see if the user’s password and the hashed password are the same. When it is a match, a JWT token is made and sent to the user through an HTTP-only cookie so as to secure the session. The token helps to confirm the user’s identity along any additional authenticated routes. 
Middleware called authMiddleware is used to secure the /dashboard route. The middleware uses the JWT secret key to check the value in the cookie against the token. Once the token is confirmed, the user gets access to the dashboard. Alternatively, the user is taken to the login page. This ensures that those who are not allowed can’t access the content. All you have to do to log out is clear the token cookie and send the user to the login page. Therefore, the user is required to log in and start over the next time they use the website. If users forget their password, they are able to ask for a reset. 
The system looks at whether the email exists and is confirmed to be valid. If that is the case, a reset token is made and stored in the user_tokens table. The user gets an email with a link that contains the token for resetting their password. A new form opens for the user when they click on the link to let them enter their new password. After the server checks the token, it hashes the newly entered password, updates the database, and takes the old token off the table. They can use this to create a new password for themselves safely. Pages are rendered with EJS templates to give dynamic output on the client side. For every route, such as /signup or /login, there is an .ejs file showing the right form or message.
The .env file helps keep database credentials, the secret key for JWT, and login details for emails hidden and protected. Doing this ensures that no hardcoded secrets are included in the code, leading to better security and flexibility.
There must be at least two tables within the PostgreSQL database. Each user has their own address, and each token also has its address. The users table keeps information on users’ names, email addresses, hashed passwords, and if they are verified. This table holds tokens meant for verification and password reset, as well as the times they expire and who they belong to.
Signup, login, and the password reset process are all validated, errors are handled, and users are properly redirected afterwards. Because of this, the system is easy to use and safe.
The reason for JWT is that it helps avoid keeping the session data on the server itself. The tokens contain their own user information, which is secretly signed using a key. That is why the system can handle more users and run efficiently.
Bcrypt makes sure that passwords are not printed in readable form. If the database is breached, attackers would have a hard time collecting the actual passwords. Tokens are designed to expire after a short amount of time if a breach happens.
Nodemailer enables the server to send emails for verification and password reset. These emails include dynamic links containing tokens, which allow users to perform secure operations without logging in.
In conclusion, this system includes all the essential features of a modern authentication flow: secure registration, email verification, JWT-based login sessions, password encryption, and secure reset mechanisms. It ensures that only valid and verified users can access protected content and provides a reliable experience for users managing their accounts in the semester registration system.
